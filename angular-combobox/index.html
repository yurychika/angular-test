<!doctype html>
<html>
<head>
<link rel='stylesheet' href='../bower_components/bootstrap/dist/css/bootstrap.min.css'/>
<style style='text/css'>
	ul{
		margin: 0px;
		padding: 0px;
	}
	li{
		list-style: none outside none;
	}

	.myCombobox{
		float: left;
		width: 200px;
		margin: 10px;
		/*border: 1px solid grey;*/
		/*border-radius: 5px;*/
	}

	.inputContainer{
		width: 100%;
	}

	.combobox-button{
		float: left;
		background: red;
		height: 100%;
		width: 10%;
	}
	.combobox-input{
		float: left;
		width: 90%;
	}

	.dropdown{
		border: 1px solid grey;
	}

	.dropdown li{
		padding: 3px;
	}

	.dropdown li:hover{
		background-color: #D3D3D0;
	}

</style>
<script src="angular.min.js"></script>
<script type='text/javascript'>
	// console.log(angular);
	angular.module('app', [])
		.controller('Controller', ['$scope', '$compile', function($scope, $compile){
			$scope.book = [
				{label: 'Angular definition guide', value: 1},
				{label: 'Head first Angular', value: 2}
			];

			$scope.country = [
				{label: 'China', value: 1},
				{label: 'USA', value: 2},
				{label: 'UK', value: 3}
			];

			$scope.addToDo = function(){
				angular.element(document.getElementById('cc')).append($compile("<todolist id='todo4' info='study'></todolist>")($scope));
			};

			// console.log('compile is');
			// console.log($compile);

		}])
		.directive('myCombobox', function(){
			return {
				restrict: 'A',
				templateUrl: 'template.html',
				replace: true,
				scope: {
					data: '=customDataStore',
					baseClass: '@baseClass'
				},
				link: function (scope, element) {
					scope.name = 'Jeff';
					console.log(element, element.forEach);
					[].forEach.apply(element, [function(el){
						// console.log(el.classList);
						el.classList.add(scope.baseClass);
					}]);
					// element.forEach(function(el){
					// 	el.classList.add(scope.baseClass);
					// });
				},
				controller: ['$scope', '$http', function($scope, $http) {
					console.log('in controller function');
					$scope._hide = true;
					$scope.value = '';
					$scope.search = '';

					$scope.toggleClick = function(){
						console.log('toggle click');
						$scope._hide = !$scope._hide;
						$scope.search = '';
					};

					$scope.select = function(e){
						$scope.value = e.target.tagName === 'SPAN'? e.target.innerHTML : e.target.querySelector('span').innerHTML;
						$scope._hide = true;
					};

					$scope.dropdownBlur = function(e){
						console.log('blur');
					};

					$scope.inputKeyPress = function(e){
						console.log(e.target.value);
						$scope.search = $scope.value;
						$scope._hide = false;
					};

					$scope.getTemp = function(city) {
						$http({
							method: 'JSONP',
							url: url + city
						}).success(function(data) {
							var weather = [];
							angular.forEach(data.list, function(value){
								weather.push(value);
							});
							$scope.weather = weather;
						});
					}
				}],
			}
		})
</script>
<link rel="stylesheet" href="todo.css">
</head>

<body >
	<div ng-app='app'>
		<div ng-controller='Controller' id='cc'>
			<!-- <button ng-click='addToDo()'>Add new to-do-list</button> -->
			<h2>Angular combobox</h2>
<!-- 				<todolist id='todo1' info='study'></todolist>
			<todolist id='todo2' info='play'></todolist>
			<todolist id='todo3' info='eat'></todolist> -->
			<div id='todo1' my-combobox custom-data-store='book' base-class='myCombobox'></div>
			<!-- <div id='todo1' my-combobox custom-data-store='country'></div> -->
<!-- 				<div id='todo2' my-combobox ng-name='play'></div>
			<div id='todo3' my-combobox ng-name='eat'></div> -->
		</div>
	</div>
</body>
</html>